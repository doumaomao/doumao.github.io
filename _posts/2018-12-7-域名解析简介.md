---
date: 2018-12-7 13:43:20+00:00
layout: post
Title: 域名解析简介
categories: doc
tags: php
---




# 域名解析简介
## 1 什么是域名解析
摘自百度百科：
域名解析就是域名到IP地址的转换过程，让人们通过注册的域名可以方便地访问到网站的一种服务。域名的解析工作由DNS服务器完成。

## 2 A记录
A (Address) 记录是用来指定域名对应的IP地址记录。用户可以将该域名下的网站服务器指向到自己的webserver上。

查看方式：`nslookup -q=a doc.bj.baidubce.com`

## 3 CNAME
别名记录。如果需要将域名指向另一个域名，再由另一个域名提供 IP 地址，就需要添加 CNAME 记录，最常用到 CNAME 的场景包括做 CDN、做企业邮箱。
查看方式： `nslookup -q=cname doc.bj.baidubce.com`
## 4 AAAA
用来指定域名对应的IPv6地址。当希望访问者通过 IPv6 地址访问您的域名时，可以使用 AAAA 记录。
查看方式： `nslookup -q=aaaa doc.bj.baidubce.com`
## 5 TXT
可填写任意字符串，长度限制255。
查看方式：`nslookup -q=txt baidu.com`

### 5.1 使用TXT解析记录的场景
1. 自身的功能声明
2. 所有权声明
3. SPF（反垃圾邮件）记录
4. 替代api做升级的版本查询

## 6 解析记录添加关键字段
### 6.1 主机记录
主机记录处填你希望的域名，常见的就是电脑网站填写www或者bbs等，手机网站您的话常见的就是wap或者m
www：解析后的域名为 www.abc.com
@：直接解析主域名 abc.com
*：泛解析，匹配其他所有域名 *.abc.com
### 6.2 记录类型
A记录、AAAA、CNAME、TXT、NS、MX等
### 6.3 线路类型
一般都填默认。当你指定线路类型比如说：电信IP，等同于只为电信IP用户提供该域名访问服务
### 6.4 记录值
根据不同的记录填写不同的值即可
### 6.5 TTL
TTL 为缓存时间，数值越小，修改记录各地生效时间越快
## 7 日常问题case集合
### 7.1 日本链路不通问题

一、背景

用户日本运营商ipv6网络访问doc.bj.baidubce.com时报网关超时问题

二、解决思路：

1. 首先确认用户ping该域名时的ip是否正确（与op沟通正确，其实是错误的）
2. 其次联系系统部同学确认链路是否正常联通

三、原因：

执行`nslookup -q=aaaa doc.bj.baidubce.com`得到的地址虽然也是个有效的地址，但其实非百度地址。

正确：2400:da00:404:2::b495:904

错误：2400:da00:404:2::495:904

op少配置了b导致出错，但是业务rd层面看不出来，两个ip看起来都是北京电信的有效ip地址。

### 7.2 证书签发商TXT解析记录验证

一、背景

在购买证书时，均需要TXT解析记录验证。企业级证书是由签发商进行验证，普通个人免费证书是由百度云进行验证

二、添加策略

企业级证书验证要求主机记录为：@域名，即直接解析主域名
个人免费证书验证要求主机记录为：dnsauth，具体看百度云的主机记录要求，需要按照要求添加记录

三、验证
执行`nslookup -q=txt baidu.com`验证是否生效，一般会有生效时间，大都是1分钟，具体可咨询op
